PROJECT(Nite)

OPTION(OPENNI_BUILD_NITE_SAMPLES "Build NITE Samples" 1)

IF (APPLE)
  file(GLOB NITE_LIBS "Lib/MacOSX/*.dylib")
ELSEIF (UNIX)
  IF (ARCHITECTURE_IS_X86_64)
    file(GLOB NITE_LIBS "Lib/Linux64/*.so")
  ELSE()
    file(GLOB NITE_LIBS "Lib/Linux32/*.so")
  ENDIF()
ENDIF()

file(COPY ${NITE_LIBS} DESTINATION ${LIBRARY_OUTPUT_PATH})
# Fix Nite binaries RPATH on Mac.
IF (APPLE)
  execute_process(COMMAND sh "${CMAKE_CURRENT_SOURCE_DIR}/apple_fix_nite_libs.sh" WORKING_DIRECTORY ${LIBRARY_OUTPUT_PATH})
ENDIF()

IF (OPENNI_BUILD_NITE_SAMPLES)
  ADD_SUBDIRECTORY(Samples/Players)
  ADD_SUBDIRECTORY(Samples/CircleControl)
  ADD_SUBDIRECTORY(Samples/Boxes)
  ADD_SUBDIRECTORY(Samples/PointViewer)
  ADD_SUBDIRECTORY(Samples/Geonect)
ENDIF()

install(FILES ${NITE_LIBS} DESTINATION lib)
file(GLOB NITE_HEADERS "Include/*.h")
INSTALL(FILES ${NITE_HEADERS} DESTINATION include)
